<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>
     <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>
      <script src="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/alertify.min.js"></script>

<!-- CSS -->
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/alertify.min.css"/>
<!-- Default theme -->
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/themes/default.min.css"/>
<!-- Semantic UI theme -->
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/themes/semantic.min.css"/>
<!-- Bootstrap theme -->
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/themes/bootstrap.min.css"/>
    <script src="https://kit.fontawesome.com/4cd99373c2.js" crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa&family=Goldman:wght@400;700&family=Inconsolata:wght@300&family=Montserrat:ital,wght@1,300&family=Orbitron:wght@500&family=Rubik:ital,wght@1,300&family=Space+Mono:ital@1&family=Teko:wght@500&family=Turret+Road:wght@500&display=swap" rel="stylesheet">

  </head>
<!-- onsubmit="sendForm(this)" method="POST"-->
  <body>
 <form id="formulario" onsubmit="sendForm(this)">
 
  <div class="mb-3">
    <label for="file" class="form-label designer">Selecciona archivo</label>
    <input type="file" class="form-control" name="file" id="file">
  </div>
  
  <button  class="btn btn-primary" id="btn_submit" type="submit" name="submit">Upload File</button>
   <button  class="btn btn-danger" id="btn_close" onclick="cerrar()">Cancelar</button>
</form>

    <br>
    <!--<h5 class="designer">Dise√±o de paginas by Roberto Ceratti</h5>-->
    <h5 class="designer">System by Roberto Ceratti</h5>
   

     <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script> 

 
<script>

function cerrar(e){
  google.script.host.close();
};



 
function sendForm(form){
 
  event.preventDefault();

  //alert(form.file);

  const boton = document.getElementById('btn_submit');
  boton.disabled = true;

   google.script.run
  .withSuccessHandler(link =>{
    alert(`Archivo subido con exito! su url es : ${link}`)
    boton.disabled = false;
  })
  .withFailureHandler(error => {
    alert(`Ups! algo salio mal , vuelve a intentarlo.. ${error}`);
    boton.disabled = false;
  })
  .subir(form);
  
  
  
};




</script>
 </body>
</html>







